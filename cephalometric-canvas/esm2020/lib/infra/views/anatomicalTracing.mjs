class AnatomicalTracingImpl {
    /**
     * Constructor
     * @param {ICanvasDraw} canvas
     */
    constructor(canvas) {
        this.canvas = canvas;
        this.allCurves = {};
    }
    /**
     * Bezier curves setter
     * @param {IBezierCurves} curves
     */
    setAllCurves(curves) {
        this.allCurves = curves;
    }
    drawCurve(curvePoints) {
        for (let position = 0; position < curvePoints.length; position += 1) {
            const points = curvePoints[position];
            if (position === 0) {
                this.canvas.drawBezier(this.canvas.getContext('bezier'), points[0], points[1], points[2], points[3], points[4], points[5], points[6], points[7], AnatomicalTracingImpl.color.stroke);
            }
            else {
                const temporary = curvePoints[position - 1];
                this.canvas.drawBezier(this.canvas.getContext('bezier'), temporary[temporary.length - 2], temporary[temporary.length - 1], points[0], points[1], points[2], points[3], points[4], points[5], AnatomicalTracingImpl.color.stroke);
            }
        }
    }
    /**
     * Draw all curves
     */
    drawAllCurves() {
        this.canvas.clearCanvas('bezier');
        for (const entry of Object.entries(this.allCurves)) {
            const element = entry[1];
            this.drawCurve(element);
        }
    }
    /**
     * Draw all control points in a given curve
     * @param {string} curveName
     */
    drawPointCircle(curveName) {
        if (this.allCurves[curveName] != null) {
            const context = this.canvas.getContext('bezier');
            //context.beginPath();
            for (let index = 0; index < this.allCurves[curveName].length; index++) {
                const element = this.allCurves[curveName][index];
                for (let subindex = 1; subindex < element.length; subindex += 2) {
                    this.canvas.drawCircle(context, element[subindex - 1], element[subindex]);
                }
            }
        }
    }
    /**
     *
     * @param {CanvasRenderingContext2D} context
     * @param {array} boxDimensions
     */
    drawBoxVertex(context, boxDimensions) {
        const selfCanvas = this.canvas;
        [
            [boxDimensions[0], boxDimensions[1]],
            [boxDimensions[0], boxDimensions[1] + boxDimensions[3]],
            [boxDimensions[0] + boxDimensions[2], boxDimensions[1]],
            [
                boxDimensions[0] + boxDimensions[2],
                boxDimensions[1] + boxDimensions[3],
            ],
        ].forEach(function (element, _index, _array) {
            selfCanvas.drawCircle.call(selfCanvas, context, element[0], element[1]);
        });
    }
    /**
     *
     * @param {string} currentCurve
     * @param {array} boxDimensions
     */
    drawCurveBox(currentCurve, boxDimensions) {
        if (currentCurve != null) {
            const context = this.canvas.getContext('bezier');
            context.beginPath();
            context.lineWidth = this.canvas.scales.lineWidth;
            context.rect(boxDimensions[0], boxDimensions[1], boxDimensions[2], boxDimensions[3]);
            context.stroke();
            this.drawBoxVertex(context, boxDimensions);
        }
    }
}
AnatomicalTracingImpl.color = Object.freeze({ fill: 'green', stroke: '#00e379' });
export default AnatomicalTracingImpl;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5hdG9taWNhbFRyYWNpbmcuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9jZXBoYWxvbWV0cmljLWNhbnZhcy9zcmMvbGliL2luZnJhL3ZpZXdzL2FuYXRvbWljYWxUcmFjaW5nLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUlBLE1BQU0scUJBQXFCO0lBS3ZCOzs7T0FHRztJQUNILFlBQVksTUFBbUI7UUFDM0IsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7UUFDckIsSUFBSSxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUM7SUFDeEIsQ0FBQztJQUVEOzs7T0FHRztJQUNILFlBQVksQ0FBQyxNQUFxQjtRQUM5QixJQUFJLENBQUMsU0FBUyxHQUFHLE1BQU0sQ0FBQztJQUM1QixDQUFDO0lBRU8sU0FBUyxDQUFDLFdBQXVCO1FBQ3JDLEtBQUssSUFBSSxRQUFRLEdBQUcsQ0FBQyxFQUFFLFFBQVEsR0FBRyxXQUFXLENBQUMsTUFBTSxFQUFFLFFBQVEsSUFBSSxDQUFDLEVBQUU7WUFDakUsTUFBTSxNQUFNLEdBQUcsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQ3JDLElBQUksUUFBUSxLQUFLLENBQUMsRUFBRTtnQkFDaEIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQ2xCLElBQUksQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxFQUNoQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQ1QsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUNULE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFDVCxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQ1QsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUNULE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFDVCxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQ1QsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUNULHFCQUFxQixDQUFDLEtBQUssQ0FBQyxNQUFNLENBQ3JDLENBQUM7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LFVBQVUsRUFDVixPQUFPLEVBQ1AsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUNWLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FDYixDQUFDO1FBQ04sQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNILFlBQVksQ0FBQyxZQUFvQixFQUFFLGFBQXVCO1FBQ3RELElBQUksWUFBWSxJQUFJLElBQUksRUFBRTtZQUN0QixNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNqRCxPQUFPLENBQUMsU0FBUyxFQUFFLENBQUM7WUFDcEIsT0FBTyxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUM7WUFDakQsT0FBTyxDQUFDLElBQUksQ0FDUixhQUFhLENBQUMsQ0FBQyxDQUFDLEVBQ2hCLGFBQWEsQ0FBQyxDQUFDLENBQUMsRUFDaEIsYUFBYSxDQUFDLENBQUMsQ0FBQyxFQUNoQixhQUFhLENBQUMsQ0FBQyxDQUFDLENBQ25CLENBQUM7WUFDRixPQUFPLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDakIsSUFBSSxDQUFDLGFBQWEsQ0FBQyxPQUFPLEVBQUUsYUFBYSxDQUFDLENBQUM7U0FDOUM7SUFDTCxDQUFDOztBQWhKYywyQkFBSyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsQ0FBQyxDQUFDO0FBbUovRSxlQUFlLHFCQUFxQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSUJlemllckN1cnZlcyB9IGZyb20gJy4uLy4uL2RvbWFpbi91dGlsL2ludGVyZmFjZXMvaW50ZXJmYWNlcyc7XHJcbmltcG9ydCB7IElDYW52YXNEcmF3IH0gZnJvbSAnLi4vLi4vZG9tYWluL3V0aWwvaW50ZXJmYWNlcy92aWV3cy9jYW52YXNEcmF3JztcclxuaW1wb3J0IHsgSVRyYWNpbmdEcmF3IH0gZnJvbSAnLi4vLi4vZG9tYWluL3V0aWwvaW50ZXJmYWNlcy92aWV3cy90cmFjaW5nRHJhdyc7XHJcblxyXG5jbGFzcyBBbmF0b21pY2FsVHJhY2luZ0ltcGwgaW1wbGVtZW50cyBJVHJhY2luZ0RyYXcge1xyXG4gICAgcHVibGljIGNhbnZhczogSUNhbnZhc0RyYXc7XHJcbiAgICBwdWJsaWMgYWxsQ3VydmVzOiBJQmV6aWVyQ3VydmVzO1xyXG4gICAgcHJpdmF0ZSBzdGF0aWMgY29sb3IgPSBPYmplY3QuZnJlZXplKHsgZmlsbDogJ2dyZWVuJywgc3Ryb2tlOiAnIzAwZTM3OScgfSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb25zdHJ1Y3RvclxyXG4gICAgICogQHBhcmFtIHtJQ2FudmFzRHJhd30gY2FudmFzXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKGNhbnZhczogSUNhbnZhc0RyYXcpIHtcclxuICAgICAgICB0aGlzLmNhbnZhcyA9IGNhbnZhcztcclxuICAgICAgICB0aGlzLmFsbEN1cnZlcyA9IHt9O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQmV6aWVyIGN1cnZlcyBzZXR0ZXJcclxuICAgICAqIEBwYXJhbSB7SUJlemllckN1cnZlc30gY3VydmVzXHJcbiAgICAgKi9cclxuICAgIHNldEFsbEN1cnZlcyhjdXJ2ZXM6IElCZXppZXJDdXJ2ZXMpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmFsbEN1cnZlcyA9IGN1cnZlcztcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGRyYXdDdXJ2ZShjdXJ2ZVBvaW50czogbnVtYmVyW11bXSk6IHZvaWQge1xyXG4gICAgICAgIGZvciAobGV0IHBvc2l0aW9uID0gMDsgcG9zaXRpb24gPCBjdXJ2ZVBvaW50cy5sZW5ndGg7IHBvc2l0aW9uICs9IDEpIHtcclxuICAgICAgICAgICAgY29uc3QgcG9pbnRzID0gY3VydmVQb2ludHNbcG9zaXRpb25dO1xyXG4gICAgICAgICAgICBpZiAocG9zaXRpb24gPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzLmRyYXdCZXppZXIoXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgnYmV6aWVyJyksXHJcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRzWzBdLFxyXG4gICAgICAgICAgICAgICAgICAgIHBvaW50c1sxXSxcclxuICAgICAgICAgICAgICAgICAgICBwb2ludHNbMl0sXHJcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRzWzNdLFxyXG4gICAgICAgICAgICAgICAgICAgIHBvaW50c1s0XSxcclxuICAgICAgICAgICAgICAgICAgICBwb2ludHNbNV0sXHJcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRzWzZdLFxyXG4gICAgICAgICAgICAgICAgICAgIHBvaW50c1s3XSxcclxuICAgICAgICAgICAgICAgICAgICBBbmF0b21pY2FsVHJhY2luZ0ltcGwuY29sb3Iuc3Ryb2tlXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGVtcG9yYXJ5ID0gY3VydmVQb2ludHNbcG9zaXRpb24gLSAxXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzLmRyYXdCZXppZXIoXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgnYmV6aWVyJyksXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcG9yYXJ5W3RlbXBvcmFyeS5sZW5ndGggLSAyXSxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wb3JhcnlbdGVtcG9yYXJ5Lmxlbmd0aCAtIDFdLFxyXG4gICAgICAgICAgICAgICAgICAgIHBvaW50c1swXSxcclxuICAgICAgICAgICAgICAgICAgICBwb2ludHNbMV0sXHJcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRzWzJdLFxyXG4gICAgICAgICAgICAgICAgICAgIHBvaW50c1szXSxcclxuICAgICAgICAgICAgICAgICAgICBwb2ludHNbNF0sXHJcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRzWzVdLFxyXG4gICAgICAgICAgICAgICAgICAgIEFuYXRvbWljYWxUcmFjaW5nSW1wbC5jb2xvci5zdHJva2VcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEcmF3IGFsbCBjdXJ2ZXNcclxuICAgICAqL1xyXG4gICAgZHJhd0FsbEN1cnZlcygpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmNhbnZhcy5jbGVhckNhbnZhcygnYmV6aWVyJyk7XHJcbiAgICAgICAgZm9yIChjb25zdCBlbnRyeSBvZiBPYmplY3QuZW50cmllcyh0aGlzLmFsbEN1cnZlcykpIHtcclxuICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IGVudHJ5WzFdO1xyXG4gICAgICAgICAgICB0aGlzLmRyYXdDdXJ2ZShlbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEcmF3IGFsbCBjb250cm9sIHBvaW50cyBpbiBhIGdpdmVuIGN1cnZlXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY3VydmVOYW1lXHJcbiAgICAgKi9cclxuICAgIGRyYXdQb2ludENpcmNsZShjdXJ2ZU5hbWU6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmFsbEN1cnZlc1tjdXJ2ZU5hbWVdICE9IG51bGwpIHtcclxuICAgICAgICAgICAgY29uc3QgY29udGV4dCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJ2JlemllcicpO1xyXG4gICAgICAgICAgICAvL2NvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgIGZvciAoXHJcbiAgICAgICAgICAgICAgICBsZXQgaW5kZXggPSAwO1xyXG4gICAgICAgICAgICAgICAgaW5kZXggPCB0aGlzLmFsbEN1cnZlc1tjdXJ2ZU5hbWVdLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIGluZGV4KytcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5hbGxDdXJ2ZXNbY3VydmVOYW1lXVtpbmRleF07XHJcbiAgICAgICAgICAgICAgICBmb3IgKFxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBzdWJpbmRleCA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgc3ViaW5kZXggPCBlbGVtZW50Lmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICBzdWJpbmRleCArPSAyXHJcbiAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbnZhcy5kcmF3Q2lyY2xlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50W3N1YmluZGV4IC0gMV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRbc3ViaW5kZXhdXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRH0gY29udGV4dFxyXG4gICAgICogQHBhcmFtIHthcnJheX0gYm94RGltZW5zaW9uc1xyXG4gICAgICovXHJcbiAgICBkcmF3Qm94VmVydGV4KFxyXG4gICAgICAgIGNvbnRleHQ6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCxcclxuICAgICAgICBib3hEaW1lbnNpb25zOiBudW1iZXJbXVxyXG4gICAgKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3Qgc2VsZkNhbnZhcyA9IHRoaXMuY2FudmFzO1xyXG4gICAgICAgIFtcclxuICAgICAgICAgICAgW2JveERpbWVuc2lvbnNbMF0sIGJveERpbWVuc2lvbnNbMV1dLFxyXG4gICAgICAgICAgICBbYm94RGltZW5zaW9uc1swXSwgYm94RGltZW5zaW9uc1sxXSArIGJveERpbWVuc2lvbnNbM11dLFxyXG4gICAgICAgICAgICBbYm94RGltZW5zaW9uc1swXSArIGJveERpbWVuc2lvbnNbMl0sIGJveERpbWVuc2lvbnNbMV1dLFxyXG4gICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICBib3hEaW1lbnNpb25zWzBdICsgYm94RGltZW5zaW9uc1syXSxcclxuICAgICAgICAgICAgICAgIGJveERpbWVuc2lvbnNbMV0gKyBib3hEaW1lbnNpb25zWzNdLFxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgIF0uZm9yRWFjaChmdW5jdGlvbiAoXHJcbiAgICAgICAgICAgIGVsZW1lbnQ6IG51bWJlcltdLFxyXG4gICAgICAgICAgICBfaW5kZXg6IG51bWJlcixcclxuICAgICAgICAgICAgX2FycmF5OiBudW1iZXJbXVtdXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHNlbGZDYW52YXMuZHJhd0NpcmNsZS5jYWxsKFxyXG4gICAgICAgICAgICAgICAgc2VsZkNhbnZhcyxcclxuICAgICAgICAgICAgICAgIGNvbnRleHQsXHJcbiAgICAgICAgICAgICAgICBlbGVtZW50WzBdLFxyXG4gICAgICAgICAgICAgICAgZWxlbWVudFsxXVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjdXJyZW50Q3VydmVcclxuICAgICAqIEBwYXJhbSB7YXJyYXl9IGJveERpbWVuc2lvbnNcclxuICAgICAqL1xyXG4gICAgZHJhd0N1cnZlQm94KGN1cnJlbnRDdXJ2ZTogc3RyaW5nLCBib3hEaW1lbnNpb25zOiBudW1iZXJbXSk6IHZvaWQge1xyXG4gICAgICAgIGlmIChjdXJyZW50Q3VydmUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgnYmV6aWVyJyk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgIGNvbnRleHQubGluZVdpZHRoID0gdGhpcy5jYW52YXMuc2NhbGVzLmxpbmVXaWR0aDtcclxuICAgICAgICAgICAgY29udGV4dC5yZWN0KFxyXG4gICAgICAgICAgICAgICAgYm94RGltZW5zaW9uc1swXSxcclxuICAgICAgICAgICAgICAgIGJveERpbWVuc2lvbnNbMV0sXHJcbiAgICAgICAgICAgICAgICBib3hEaW1lbnNpb25zWzJdLFxyXG4gICAgICAgICAgICAgICAgYm94RGltZW5zaW9uc1szXVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xyXG4gICAgICAgICAgICB0aGlzLmRyYXdCb3hWZXJ0ZXgoY29udGV4dCwgYm94RGltZW5zaW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBBbmF0b21pY2FsVHJhY2luZ0ltcGw7XHJcbiJdfQ==