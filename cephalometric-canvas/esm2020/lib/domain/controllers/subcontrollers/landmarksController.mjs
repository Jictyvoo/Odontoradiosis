import { LocalRepositoryImpl } from '../../../infra/repositories/localStorage.repository';
class LandmarksController {
    /**
     *
     * @param {ICanvasDraw} canvasOdontoradiosis
     */
    constructor(canvasOdontoradiosis) {
        this.landmarks = {};
        this.canvas = canvasOdontoradiosis;
        this.localRepository = new LocalRepositoryImpl();
    }
    /**
     * @returns {ILandmarkArray} this.landmarks
     */
    getLandmarks() {
        return this.landmarks;
    }
    /**
     * Lardmarks setter
     * @param {ILandmarkArray} newLandmarks
     */
    setLandmarks(newLandmarks) {
        this.landmarks = newLandmarks;
    }
    /**
     * Set a single landmark value
     * @param {string} name
     * @param {ILandmark} value
     */
    setLandmark(name, value = { x: 0, y: 0 }) {
        this.landmarks[name] = value;
    }
    /**
     * Verify if landmark exists. If not and toCreate is true, it'll create
     * @param {string} name
     * @param {boolean} toCreate
     * @returns {ILandmark}
     */
    verifyLandmark(name, toCreate = false) {
        if (!this.landmarks[name] && toCreate) {
            this.landmarks[name] = { x: 0, y: 0 };
        }
        return this.landmarks[name];
    }
    /**
     * Save all landmarks in a hidden form
     */
    saveLandmarks() {
        const data_json = JSON.stringify(this.landmarks);
        this.localRepository.set('saved_points', data_json);
    }
    /**
     * Draw a landmark with its name
     * @param {CanvasRenderingContext2D} canvasContext
     * @param {string} landmarkName
     */
    drawLandmark(canvasContext, landmarkName) {
        const locations = this.landmarks[landmarkName];
        const context = canvasContext;
        const readyToShowName = landmarkName.match(/\(.+\)/);
        if (readyToShowName) {
            this.canvas.drawCircleCtx('landmarks', locations.x, locations.y, this.canvas.scales.pointRadius, 1, LandmarksController.color.fill, LandmarksController.color.stroke);
            context.beginPath();
            context.fillStyle = LandmarksController.color.fill;
            context.font = this.canvas.scales.nameScale + 'px Arial';
            context.fillText(readyToShowName.toString(), Math.floor(locations.x - this.canvas.scales.textRelativePosition.x), Math.floor(locations.y + this.canvas.scales.textRelativePosition.y));
            context.fill();
            context.lineWidth = 1;
            context.strokeStyle = LandmarksController.color.stroke;
            context.stroke();
        }
    }
    /**
     * Redraw all landmarks
     */
    redrawLandmarks() {
        const landmarksCanvas = this.canvas.getCanvas('landmarks');
        const context = landmarksCanvas.getContext('2d');
        context.clearRect(0, 0, landmarksCanvas.width, landmarksCanvas.height);
        const self = this;
        Object.keys(this.landmarks).forEach(function (element, _index, _array) {
            self.drawLandmark.call(self, context, element);
        });
    }
}
LandmarksController.color = Object.freeze({ fill: 'red', stroke: '#330005' });
export default LandmarksController;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGFuZG1hcmtzQ29udHJvbGxlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2NlcGhhbG9tZXRyaWMtY2FudmFzL3NyYy9saWIvZG9tYWluL2NvbnRyb2xsZXJzL3N1YmNvbnRyb2xsZXJzL2xhbmRtYXJrc0NvbnRyb2xsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0scURBQXFELENBQUM7QUFLMUYsTUFBTSxtQkFBbUI7SUFNckI7OztPQUdHO0lBQ0gsWUFBWSxvQkFBaUM7UUFDekMsSUFBSSxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUM7UUFDcEIsSUFBSSxDQUFDLE1BQU0sR0FBRyxvQkFBb0IsQ0FBQztRQUNuQyxJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksbUJBQW1CLEVBQUUsQ0FBQztJQUNyRCxDQUFDO0lBRUQ7O09BRUc7SUFDSCxZQUFZO1FBQ1IsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDO0lBQzFCLENBQUM7SUFFRDs7O09BR0c7SUFDSCxZQUFZLENBQUMsWUFBNEI7UUFDckMsSUFBSSxDQUFDLFNBQVMsR0FBRyxZQUFZLENBQUM7SUFDbEMsQ0FBQztJQUVEOzs7O09BSUc7SUFDSCxXQUFXLENBQUMsSUFBWSxFQUFFLFFBQW1CLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFO1FBQ3ZELElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEdBQUcsS0FBSyxDQUFDO0lBQ2pDLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNILGNBQWMsQ0FBQyxJQUFZLEVBQUUsV0FBb0IsS0FBSztRQUNsRCxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsSUFBSSxRQUFRLEVBQUU7WUFDbkMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRSxD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RSxDQUFDLENBQUM7QUFrSDdFLGVBQWUsbUJBQW1CLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBMb2NhbFJlcG9zaXRvcnlJbXBsIH0gZnJvbSAnLi4vLi4vLi4vaW5mcmEvcmVwb3NpdG9yaWVzL2xvY2FsU3RvcmFnZS5yZXBvc2l0b3J5JztcclxuaW1wb3J0IHsgSUxhbmRtYXJrLCBJTGFuZG1hcmtBcnJheSB9IGZyb20gJy4uLy4uL3V0aWwvaW50ZXJmYWNlcy9pbnRlcmZhY2VzJztcclxuaW1wb3J0IHsgSUxvY2FsUmVwb3NpdG9yeSB9IGZyb20gJy4uLy4uL3V0aWwvaW50ZXJmYWNlcy9yZXBvc2l0b3JpZXMnO1xyXG5pbXBvcnQgeyBJQ2FudmFzRHJhdyB9IGZyb20gJy4uLy4uL3V0aWwvaW50ZXJmYWNlcy92aWV3cy9jYW52YXNEcmF3JztcclxuXHJcbmNsYXNzIExhbmRtYXJrc0NvbnRyb2xsZXIge1xyXG4gICAgcHVibGljIGxhbmRtYXJrczogSUxhbmRtYXJrQXJyYXk7XHJcbiAgICBwdWJsaWMgY2FudmFzOiBJQ2FudmFzRHJhdztcclxuICAgIHByaXZhdGUgbG9jYWxSZXBvc2l0b3J5OiBJTG9jYWxSZXBvc2l0b3J5O1xyXG4gICAgcHJpdmF0ZSBzdGF0aWMgY29sb3IgPSBPYmplY3QuZnJlZXplKHsgZmlsbDogJ3JlZCcsIHN0cm9rZTogJyMzMzAwMDUnIH0pO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SUNhbnZhc0RyYXd9IGNhbnZhc09kb250b3JhZGlvc2lzXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKGNhbnZhc09kb250b3JhZGlvc2lzOiBJQ2FudmFzRHJhdykge1xyXG4gICAgICAgIHRoaXMubGFuZG1hcmtzID0ge307XHJcbiAgICAgICAgdGhpcy5jYW52YXMgPSBjYW52YXNPZG9udG9yYWRpb3NpcztcclxuICAgICAgICB0aGlzLmxvY2FsUmVwb3NpdG9yeSA9IG5ldyBMb2NhbFJlcG9zaXRvcnlJbXBsKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcmV0dXJucyB7SUxhbmRtYXJrQXJyYXl9IHRoaXMubGFuZG1hcmtzXHJcbiAgICAgKi9cclxuICAgIGdldExhbmRtYXJrcygpOiBJTGFuZG1hcmtBcnJheSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubGFuZG1hcmtzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTGFyZG1hcmtzIHNldHRlclxyXG4gICAgICogQHBhcmFtIHtJTGFuZG1hcmtBcnJheX0gbmV3TGFuZG1hcmtzXHJcbiAgICAgKi9cclxuICAgIHNldExhbmRtYXJrcyhuZXdMYW5kbWFya3M6IElMYW5kbWFya0FycmF5KTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5sYW5kbWFya3MgPSBuZXdMYW5kbWFya3M7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgYSBzaW5nbGUgbGFuZG1hcmsgdmFsdWVcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXHJcbiAgICAgKiBAcGFyYW0ge0lMYW5kbWFya30gdmFsdWVcclxuICAgICAqL1xyXG4gICAgc2V0TGFuZG1hcmsobmFtZTogc3RyaW5nLCB2YWx1ZTogSUxhbmRtYXJrID0geyB4OiAwLCB5OiAwIH0pOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmxhbmRtYXJrc1tuYW1lXSA9IHZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVmVyaWZ5IGlmIGxhbmRtYXJrIGV4aXN0cy4gSWYgbm90IGFuZCB0b0NyZWF0ZSBpcyB0cnVlLCBpdCdsbCBjcmVhdGVcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IHRvQ3JlYXRlXHJcbiAgICAgKiBAcmV0dXJucyB7SUxhbmRtYXJrfVxyXG4gICAgICovXHJcbiAgICB2ZXJpZnlMYW5kbWFyayhuYW1lOiBzdHJpbmcsIHRvQ3JlYXRlOiBib29sZWFuID0gZmFsc2UpOiBJTGFuZG1hcmsge1xyXG4gICAgICAgIGlmICghdGhpcy5sYW5kbWFya3NbbmFtZV0gJiYgdG9DcmVhdGUpIHtcclxuICAgICAgICAgICAgdGhpcy5sYW5kbWFya3NbbmFtZV0gPSB7IHg6IDAsIHk6IDAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubGFuZG1hcmtzW25hbWVdO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU2F2ZSBhbGwgbGFuZG1hcmtzIGluIGEgaGlkZGVuIGZvcm1cclxuICAgICAqL1xyXG4gICAgc2F2ZUxhbmRtYXJrcygpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBkYXRhX2pzb24gPSBKU09OLnN0cmluZ2lmeSh0aGlzLmxhbmRtYXJrcyk7XHJcbiAgICAgICAgdGhpcy5sb2NhbFJlcG9zaXRvcnkuc2V0KCdzYXZlZF9wb2ludHMnLCBkYXRhX2pzb24pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRHJhdyBhIGxhbmRtYXJrIHdpdGggaXRzIG5hbWVcclxuICAgICAqIEBwYXJhbSB7Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEfSBjYW52YXNDb250ZXh0XHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbGFuZG1hcmtOYW1lXHJcbiAgICAgKi9cclxuICAgIGRyYXdMYW5kbWFyayhcclxuICAgICAgICBjYW52YXNDb250ZXh0OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsXHJcbiAgICAgICAgbGFuZG1hcmtOYW1lOiBzdHJpbmdcclxuICAgICk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGxvY2F0aW9ucyA9IHRoaXMubGFuZG1hcmtzW2xhbmRtYXJrTmFtZV07XHJcbiAgICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhc0NvbnRleHQ7XHJcbiAgICAgICAgY29uc3QgcmVhZHlUb1Nob3dOYW1lID0gbGFuZG1hcmtOYW1lLm1hdGNoKC9cXCguK1xcKS8pO1xyXG4gICAgICAgIGlmIChyZWFkeVRvU2hvd05hbWUpIHtcclxuICAgICAgICAgICAgdGhpcy5jYW52YXMuZHJhd0NpcmNsZUN0eChcclxuICAgICAgICAgICAgICAgICdsYW5kbWFya3MnLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25zLngsXHJcbiAgICAgICAgICAgICAgICBsb2NhdGlvbnMueSxcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzLnNjYWxlcy5wb2ludFJhZGl1cyxcclxuICAgICAgICAgICAgICAgIDEsXHJcbiAgICAgICAgICAgICAgICBMYW5kbWFya3NDb250cm9sbGVyLmNvbG9yLmZpbGwsXHJcbiAgICAgICAgICAgICAgICBMYW5kbWFya3NDb250cm9sbGVyLmNvbG9yLnN0cm9rZVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IExhbmRtYXJrc0NvbnRyb2xsZXIuY29sb3IuZmlsbDtcclxuICAgICAgICAgICAgY29udGV4dC5mb250ID0gdGhpcy5jYW52YXMuc2NhbGVzLm5hbWVTY2FsZSArICdweCBBcmlhbCc7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZmlsbFRleHQoXHJcbiAgICAgICAgICAgICAgICByZWFkeVRvU2hvd05hbWUudG9TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIE1hdGguZmxvb3IoXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25zLnggLSB0aGlzLmNhbnZhcy5zY2FsZXMudGV4dFJlbGF0aXZlUG9zaXRpb24ueFxyXG4gICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgIE1hdGguZmxvb3IoXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25zLnkgKyB0aGlzLmNhbnZhcy5zY2FsZXMudGV4dFJlbGF0aXZlUG9zaXRpb24ueVxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGwoKTtcclxuICAgICAgICAgICAgY29udGV4dC5saW5lV2lkdGggPSAxO1xyXG4gICAgICAgICAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gTGFuZG1hcmtzQ29udHJvbGxlci5jb2xvci5zdHJva2U7XHJcbiAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVkcmF3IGFsbCBsYW5kbWFya3NcclxuICAgICAqL1xyXG4gICAgcmVkcmF3TGFuZG1hcmtzKCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGxhbmRtYXJrc0NhbnZhcyA9IHRoaXMuY2FudmFzLmdldENhbnZhcygnbGFuZG1hcmtzJyk7XHJcbiAgICAgICAgY29uc3QgY29udGV4dCA9IGxhbmRtYXJrc0NhbnZhcy5nZXRDb250ZXh0KFxyXG4gICAgICAgICAgICAnMmQnXHJcbiAgICAgICAgKSBhcyBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQ7XHJcbiAgICAgICAgY29udGV4dC5jbGVhclJlY3QoMCwgMCwgbGFuZG1hcmtzQ2FudmFzLndpZHRoLCBsYW5kbWFya3NDYW52YXMuaGVpZ2h0KTtcclxuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmxhbmRtYXJrcykuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCwgX2luZGV4LCBfYXJyYXkpIHtcclxuICAgICAgICAgICAgc2VsZi5kcmF3TGFuZG1hcmsuY2FsbChzZWxmLCBjb250ZXh0LCBlbGVtZW50KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgTGFuZG1hcmtzQ29udHJvbGxlcjtcclxuIl19